<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio Optimizer</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2 class="sidebar-title">Stock Selection</h2>
                <button class="theme-toggle" id="themeToggle" title="Toggle theme">
                    <span class="theme-icon">☀️</span>
                </button>
            </div>

            <!-- Stock Chips -->
            <div class="stock-chips" id="stockChips"></div>

            <!-- Add Stock Button -->
            <button class="add-stock-btn" id="addStockBtn">+ Add Stock</button>

            <!-- Dropdown -->
            <div class="stock-dropdown" id="stockDropdown" style="display: none;">
                <input type="text" class="search-input" id="searchInput" placeholder="Search stocks...">
                <div class="stock-list" id="stockList"></div>
            </div>

            <!-- Time Horizon -->
            <div class="control-group">
                <label class="control-label">Time Horizon</label>
                <select class="select-field" id="timeHorizon">
                    <option value="1">1 Month</option>
                    <option value="3">3 Months</option>
                    <option value="6">6 Months</option>
                    <option value="12" selected>1 Year</option>
                    <option value="24">2 Years</option>
                    <option value="60">5 Years</option>
                    <option value="120">10 Years</option>
                    <option value="custom">Custom Date Range</option>
                </select>
            </div>

            <!-- Custom Date Range (Hidden by default) -->
            <div class="control-group" id="customDateGroup" style="display: none;">
                <label class="control-label">Start Date</label>
                <input type="date" class="input-field" id="startDate">
                <label class="control-label" style="margin-top: 0.5rem;">End Date</label>
                <input type="date" class="input-field" id="endDate">
            </div>

            <!-- Investment Amount -->
            <div class="control-group">
                <label class="control-label">Investment Amount</label>
                <input type="number" class="input-field" id="investmentAmount" value="100000" min="1000" step="1000">
            </div>

            <!-- Risk Tolerance -->
            <div class="control-group">
                <label class="control-label">
                    Risk Tolerance
                    <span class="tooltip-icon">i
                        <span class="tooltip-content">Conservative minimizes volatility (safest). Moderate balances risk and return. Aggressive maximizes returns (highest risk). Choose based on your comfort with market fluctuations.</span>
                    </span>
                </label>
                <select class="select-field" id="riskTolerance">
                    <option value="conservative">Conservative</option>
                    <option value="moderate" selected>Moderate</option>
                    <option value="aggressive">Aggressive</option>
                </select>
            </div>

            <!-- S&P 500 Comparison -->
            <div class="control-group">
                <label class="checkbox-label">
                    <input type="checkbox" id="compareSP500" checked>
                    <span>Compare to S&P 500</span>
                </label>
            </div>

            <!-- Optimize Button -->
            <button class="optimize-btn" id="optimizeBtn">Optimize Portfolio</button>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Loading -->
            <div class="loading-overlay" id="loadingOverlay" style="display: none;">
                <div class="loading-spinner"></div>
                <p>Analyzing portfolio...</p>
            </div>

            <!-- Hero Section -->
            <div class="hero-section" id="heroSection">
                <div class="hero-content">
                    <h1 class="hero-title">Maximize Returns. Minimize Risk. Science-Backed.</h1>
                    <p class="hero-subtitle">Portfolio optimization using Nobel Prize-winning Modern Portfolio Theory. See if your picks beat the S&P 500.</p>

                    <div class="hero-stats">
                        <div class="hero-stat">
                            <div class="hero-stat-value">50+</div>
                            <div class="hero-stat-label">Assets Supported</div>
                        </div>
                        <div class="hero-stat">
                            <div class="hero-stat-value">Real-Time</div>
                            <div class="hero-stat-label">Market Data</div>
                        </div>
                        <div class="hero-stat">
                            <div class="hero-stat-value">Proven</div>
                            <div class="hero-stat-label">Mathematics</div>
                        </div>
                    </div>

                    <button class="demo-btn" id="demoBtn">Try Demo Portfolio</button>
                </div>
            </div>

            <!-- Results Container (Hidden until optimization) -->
            <div class="results-container" id="resultsContainer" style="display: none;">

            <!-- Metrics Cards -->
            <div class="metrics-row">
                <div class="metric-card metric-best">
                    <div class="metric-label">Best Stock</div>
                    <div class="metric-ticker" id="bestStock">--</div>
                    <div class="metric-value positive" id="bestGain">--</div>
                </div>
                <div class="metric-card metric-worst">
                    <div class="metric-label">Worst Stock</div>
                    <div class="metric-ticker" id="worstStock">--</div>
                    <div class="metric-value negative" id="worstLoss">--</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label-with-tooltip">
                        <span>Expected Return</span>
                        <span class="tooltip-icon">i
                            <span class="tooltip-content">Average annual return based on historical data. This is a projection and doesn't guarantee future results. Higher percentages indicate better potential returns.</span>
                        </span>
                    </div>
                    <div class="metric-value" id="expectedReturn">--</div>
                </div>
                <div class="metric-card">
                    <div class="metric-label-with-tooltip">
                        <span>Sharpe Ratio</span>
                        <span class="tooltip-icon">i
                            <span class="tooltip-content">Risk-adjusted return measure. Higher is better. Above 1.0 is good, above 2.0 is excellent. It tells you if extra return is worth the extra risk.</span>
                        </span>
                    </div>
                    <div class="metric-value" id="sharpeRatio">--</div>
                </div>
                <div class="metric-card" id="sp500Card" style="display: none;">
                    <div class="metric-label-with-tooltip">
                        <span>vs S&P 500</span>
                        <span class="tooltip-icon">i
                            <span class="tooltip-content">Compares your portfolio to the S&P 500 benchmark. Positive means you're beating the market. Negative means index funds might be better.</span>
                        </span>
                    </div>
                    <div class="metric-value" id="sp500Comparison">--</div>
                </div>
            </div>

            <!-- Main Chart -->
            <div class="chart-container">
                <h3 class="chart-title">Normalized Price Performance</h3>
                <div id="normalizedChart" class="chart"></div>
            </div>

            <!-- Portfolio Growth -->
            <div class="chart-container">
                <h3 class="chart-title">Portfolio Growth</h3>
                <div id="portfolioChart" class="chart"></div>
            </div>

            <!-- Risk Analysis Section -->
            <div class="risk-analysis-section" id="riskAnalysisSection" style="display: none;">
                <h3 class="section-title">Risk Analysis</h3>
                <div class="risk-metrics-grid">
                    <div class="risk-metric-card">
                        <div class="risk-metric-label-with-tooltip">
                            <span>Value at Risk (95%)</span>
                            <span class="tooltip-icon">i
                                <span class="tooltip-content">There's only a 5% chance you'll lose more than this amount in a single day. This helps you understand your worst-case daily loss under normal market conditions.</span>
                            </span>
                        </div>
                        <div class="risk-metric-value" id="var95Value">--</div>
                        <div class="risk-metric-description">95% confidence daily loss limit</div>
                    </div>

                    <div class="risk-metric-card">
                        <div class="risk-metric-label-with-tooltip">
                            <span>Value at Risk (99%)</span>
                            <span class="tooltip-icon">i
                                <span class="tooltip-content">There's only a 1% chance you'll lose more than this amount in a single day. This represents an extreme but still plausible worst-case scenario.</span>
                            </span>
                        </div>
                        <div class="risk-metric-value" id="var99Value">--</div>
                        <div class="risk-metric-description">99% confidence daily loss limit</div>
                    </div>

                    <div class="risk-metric-card">
                        <div class="risk-metric-label-with-tooltip">
                            <span>Maximum Drawdown</span>
                            <span class="tooltip-icon">i
                                <span class="tooltip-content">The largest peak-to-trough decline in your portfolio value historically. This shows the worst loss you would have experienced if you bought at the peak and held through the trough.</span>
                            </span>
                        </div>
                        <div class="risk-metric-value" id="maxDrawdownValue">--</div>
                        <div class="risk-metric-description" id="maxDrawdownDescription">Historical worst decline</div>
                    </div>
                </div>
            </div>

            <!-- Two Column Charts -->
            <div class="chart-grid">
                <div class="chart-container">
                    <h3 class="chart-title-with-tooltip">
                        <span>Efficient Frontier</span>
                        <span class="tooltip-icon">i
                            <span class="tooltip-content">Shows the best possible portfolios for each risk level. The curve represents optimal combinations where you can't get higher returns without taking more risk. Your optimal portfolio is marked with a star.</span>
                        </span>
                    </h3>
                    <div id="frontierChart" class="chart"></div>
                </div>
                <div class="chart-container">
                    <h3 class="chart-title-with-tooltip">
                        <span>Portfolio Allocation</span>
                        <span class="tooltip-icon">i
                            <span class="tooltip-content">Your recommended stock weights based on mathematical optimization. Percentages show how much of your investment should go into each stock for the best risk-adjusted returns.</span>
                        </span>
                    </h3>
                    <div id="allocationChart" class="chart"></div>
                    <div class="export-buttons" id="exportButtons" style="display: none;">
                        <button class="export-btn" id="exportCSV">Export Allocation (CSV)</button>
                        <button class="export-btn" id="exportTXT">Export Report (TXT)</button>
                    </div>
                </div>
            </div>

            <!-- Correlation Matrix -->
            <div class="chart-container">
                <h3 class="chart-title-with-tooltip">
                    <span>Correlation Matrix</span>
                    <span class="tooltip-icon">i
                        <span class="tooltip-content">Shows how stocks move together. Values near 1.0 mean stocks move in sync (less diversification). Values near 0 or negative mean stocks move independently (better diversification and risk reduction).</span>
                    </span>
                </h3>
                <div id="correlationChart" class="chart"></div>
            </div>

            </div> <!-- End Results Container -->
        </main>
    </div>

    <script src="https://cdn.plot.ly/plotly-2.26.0.min.js"></script>
    <script src="js/api.js"></script>
    <script src="js/charts.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
